"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7539],{4415:(e,a,l)=>{l.r(a),l.d(a,{assets:()=>r,contentTitle:()=>t,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"ecosystem-leaked-globals","title":"single-spa-leaked-globals","description":"single-spa-leaked-globals is a helper library for dealing with single-spa-applications","source":"@site/versioned_docs/version-5.x/ecosystem-leaked-globals.md","sourceDirName":".","slug":"/ecosystem-leaked-globals","permalink":"/docs/5.x/ecosystem-leaked-globals","draft":false,"unlisted":false,"editUrl":"https://github.com/single-spa/single-spa.js.org/blob/master/website/versioned_docs/version-5.x/ecosystem-leaked-globals.md","tags":[],"version":"5.x","frontMatter":{"id":"ecosystem-leaked-globals","title":"single-spa-leaked-globals","sidebar_label":"Leaked globals"},"sidebar":"docs","previous":{"title":"HTML / Web Components","permalink":"/docs/5.x/ecosystem-html-web-components"},"next":{"title":"Dojo","permalink":"/docs/5.x/ecosystem-dojo"}}');var n=l(4848),o=l(8453);const i={id:"ecosystem-leaked-globals",title:"single-spa-leaked-globals",sidebar_label:"Leaked globals"},t=void 0,r={},d=[{value:"What single-spa-leaked-globals does",id:"what-single-spa-leaked-globals-does",level:2},{value:"Before using single-spa-leaked-globals",id:"before-using-single-spa-leaked-globals",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Installation",id:"installation",level:2},{value:"Via npm",id:"via-npm",level:3},{value:"Via cdn",id:"via-cdn",level:3},{value:"Usage",id:"usage",level:2},{value:"API / Options",id:"api--options",level:2}];function c(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.a,{href:"https://github.com/single-spa/single-spa-leaked-globals",children:"single-spa-leaked-globals"})," is a helper library for dealing with single-spa-applications\nthat depend on global variables. Such applications are usually applications that use AngularJS, Backbone, or other older frameworks\nthat were popular when ES modules were not yet available."]}),"\n",(0,n.jsx)(a.h2,{id:"what-single-spa-leaked-globals-does",children:"What single-spa-leaked-globals does"}),"\n",(0,n.jsxs)(a.p,{children:["single-spa-leaked-globals will remove specific global variables from ",(0,n.jsx)(a.code,{children:"window"})," during your application's\n",(0,n.jsx)(a.a,{href:"/docs/building-applications#unmount",children:"unmount lifecycle"}),", and add them back to ",(0,n.jsx)(a.code,{children:"window"})," during your application's\n",(0,n.jsx)(a.a,{href:"/docs/building-applications#mount",children:"mount lifecycle"}),"."]}),"\n",(0,n.jsx)(a.h2,{id:"before-using-single-spa-leaked-globals",children:"Before using single-spa-leaked-globals"}),"\n",(0,n.jsx)(a.p,{children:"It might be okay for single-spa applications to leak some global variables. Those leaked global variables could be harmless. Below are some\nsituations where using single-spa-leaked-globals could be useful. If your situation is not listed, consider not using single-spa-leaked-globals."}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["Your applications are accidentally sharing global variables and the order in which they are mounted matters. For example, the jQuery ",(0,n.jsx)(a.code,{children:"$"})," variable\nis available at the start, but app1 installs a jQuery plugin that app2 assumes is there. If app2 is mounted\nbefore app1, you might get an error because the jQuery plugin is not installed. In that situation, the best solution is maybe to install\nthe jQuery plugin inside of your ",(0,n.jsx)(a.a,{href:"/docs/configuration",children:"single-spa config"}),". But if that's not desireable, you can use single-spa-leaked-globals\nto manage two separate versions of jQuery -- one for app1 and one for app2."]}),"\n",(0,n.jsxs)(a.li,{children:["Your applications require different versions of the same global variable. For example, consider when app1 depends on\nan ",(0,n.jsx)(a.a,{href:"https://underscorejs.org/",children:"underscorejs"})," ",(0,n.jsx)(a.code,{children:"_"})," global variable and app2 depends on a ",(0,n.jsx)(a.a,{href:"https://lodash.com/",children:"lodash"})," ",(0,n.jsx)(a.code,{children:"_"})," global variable.\nThey both need a global ",(0,n.jsx)(a.code,{children:"_"})," variable, but expect different functions to be available on it. The same could be true for different versions of the\nsame library, such as lodash 3 vs lodash 4. In those situations, you can use single-spa-leaked-globals to make sure the ",(0,n.jsx)(a.code,{children:"_"})," that is available\nfor app1 and app2 is the correct one."]}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"limitations",children:"Limitations"}),"\n",(0,n.jsxs)(a.p,{children:["single-spa-leaked-globals cannot change the global nature of global dependencies. Only one instance of the global variable can be on the\n",(0,n.jsx)(a.code,{children:"window"})," at a time. ",(0,n.jsx)(a.strong,{children:"This means that you probably can only have one application mounted at a time that depends on that global variable."}),"\nIf two applications depend on the same global variable and are ",(0,n.jsx)(a.a,{href:"/docs/configuration#activity-function",children:"active"})," at the same time,\nsingle-spa-leaked-globals won't work for you."]}),"\n",(0,n.jsx)(a.h2,{id:"installation",children:"Installation"}),"\n",(0,n.jsx)(a.h3,{id:"via-npm",children:"Via npm"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-sh",children:"npm install --save single-spa-leaked-globals\n\n# or\nyarn add single-spa-leaked-globals\n"})}),"\n",(0,n.jsx)(a.h3,{id:"via-cdn",children:"Via cdn"}),"\n",(0,n.jsx)(a.p,{children:"You can also use single-spa-leaked-globals via CDN, ironically as a global variable itself:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-html",children:'<script src="https://cdn.jsdelivr.net/npm/single-spa-leaked-globals"><\/script>\n'})}),"\n",(0,n.jsxs)(a.p,{children:["Note that you should probably lock down the version of the library to avoid accidentally upgrading. See\n",(0,n.jsx)(a.a,{href:"https://cdn.jsdelivr.net/npm/single-spa-leaked-globals/",children:"https://cdn.jsdelivr.net/npm/single-spa-leaked-globals/"})," to find the latest version."]}),"\n",(0,n.jsx)(a.h2,{id:"usage",children:"Usage"}),"\n",(0,n.jsxs)(a.p,{children:["The single-spa-leaked-globals library is often used in conjunction with another helper library, such as\nsingle-spa-angularjs or single-spa-backbone. As such, you'll want to\n",(0,n.jsx)(a.a,{href:"/docs/building-applications#registered-application-lifecycle",children:"export an array"})," for your lifecycle functions\ninstead of exporting just a function."]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-js",children:"import singleSpaLeakedGlobals from 'single-spa-leaked-globals';\n\n// Use single-spa-angularjs, single-spa-backbone, etc to get your framework specific lifecycles\nconst frameworkLifecycles = ...\n\nconst leakedGlobalsLifecycles = singleSpaLeakedGlobals({\n  globalVariableNames: ['$', 'jQuery', '_'],\n})\n\nexport const bootstrap = [\n  leakedGlobalsLifecycles.bootstrap,\n  frameworkLifecycles.bootstrap,\n]\n\nexport const mount = [\n  // Make sure leaked globals lifecycles' mount function is **before** other lifecycles' mount\n  // This is so the global vars are available when the framework mounts\n  leakedGlobalsLifecycles.mount,\n  frameworkLifecycles.mount,\n]\n\nexport const unmount = [\n  leakedGlobalsLifecycles.unmount,\n  // Make sure leaked globals lifecycles' unmount function is **after** other lifecycles' unmount\n  // This is so the global vars are still available during the framework unmount lifecycle function.\n  frameworkLifecycles.unmount,\n]\n"})}),"\n",(0,n.jsx)(a.p,{children:"If you're using single-spa-leaked-globals as a global variable itself:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-js",children:'const leakedGlobalsLifecycles = window.singleSpaLeakedGlobals.default({\n  globalVariableNames: ["_"],\n});\n'})}),"\n",(0,n.jsx)(a.h2,{id:"api--options",children:"API / Options"}),"\n",(0,n.jsx)(a.p,{children:"single-spa-leaked-globals is called with an object with the following properties:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"globalVariableNames"})," (required): An array of strings. Each string is the name of a global variable that should\nbe removed when the application is unmounted, and added back when the application is mounted."]}),"\n"]})]})}function p(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,a,l)=>{l.d(a,{R:()=>i,x:()=>t});var s=l(6540);const n={},o=s.createContext(n);function i(e){const a=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(o.Provider,{value:a},e.children)}}}]);